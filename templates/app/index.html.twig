{% extends "base.html.twig"  %}
{% set page = 'app' %}
{% block title %}Apps - XIVAPI{% endblock %}

{% block body %}
<div class="two-pane">
    <aside>
        {% include 'app/nav.html.twig' %}
    </aside>
    <main>
        {% if auth.user %}

            <h1>
                {{ auth.user.apps|length }} Apps
                <small>&nbsp;&nbsp;&nbsp; Max {{ auth.user.appsMax }}</small>
            </h1>

            {% if not auth.user.isBanned() %}
                <p>
                    {% if auth.user.apps|length < auth.user.appsMax %}
                        <a href="{{ path('app_manage', { id: 'new' }) }}" class="btn btn-primary">Create a new app</a>
                    {% else %}
                        You cannot make anymore dev applications at this time.
                        {% if auth.user.level == 2 %}Your limit will increase to 5 after 1 hour{% endif %}
                    {% endif %}
                </p>
            {% endif %}

            {% if auth.user.isBanned() %}
                <div class="alert alert-danger">
                    <h4>Account Banned</h4>
                    <p>Hello, your account has been banned on XIVAPI. This is likely due to API abuse or crawl detection, if you
                        believe this is in error or want to know more please <a href="https://discord.gg/MFFVHWC">Join Discord</a>
                        and ask one of the moderators for assistance.</p>
                </div>
            {% endif %}

            {% if auth.user.isLimited() %}
                <div class="alert alert-warning">
                    <h4>Account Limited</h4>
                    <p><strong>Welcome to XIVAPI!</strong></p>
                    <p>As your account is new you are currently in a limited state. This means you can create
                        <strong>1 App</strong> with <strong>2/req/sec</strong> rate limit. This restriction
                        will be lifted after 1 hour. This gives you time to have a play with some of the
                        API endpoints and think about what you really need to do!</p>
                    <p>If you have any questions, please: <a href="https://discord.gg/MFFVHWC">Join Discord</a></p>
                </div>
            {% endif %}

            {% include 'app/list.html.twig' %}

            <br><hr><br>

            <strong>The do's and don't of API usage!</strong>
            <br>
            <ul>
                <li><span class="text-success">DO</span> build awesome stuff, even if it already exists.</li>
                <li><span class="text-success">DO</span> ask for help if you want any advice! <a href="https://discord.gg/MFFVHWC">jump on discord</a>, we're friendly!</li>
                <li><span class="text-success">DO</span> cache your requests, consider your queries and app flow.</li>
                <li><span class="text-success">DO</span> get in touch if you want any custom data, this is a community driven api</li>
                <li><span class="text-danger">DO NOT</span> crawl/scrape the API to try get every bit of information. <i>You will be banned</i>. <a href="https://github.com/viion/ffxiv-datamining">Learn about data-mining here</a>.</li>
                <li><span class="text-danger">DO NOT</span> spam the api, you will be rate limited anyway so save yourself the hassle! :)</li>
            </ul>
            <br>

            <p><strong>Worried about being banned?</strong> - Dont, unless you do some serious crawling you wont be.
                If you make something cool and it goes viral, this is not the same behaviour as crawlers/bots/scrapers.</p>

            <p><strong>Why do I need a key?</strong> - You need a key to access the entire API. This is so the service
            can be monitored for spam/abuse. XIVAPI is for everyone! Plus you get sweet rate limits and analytics.</p>

            <p><strong>What if someone steals my key?</strong> - You can change your key at anytime and break their app.
            Then go tell them to get their own key, it costs nothing.</p>

        {% else %}
            {% include 'app/login.html.twig' %}
        {% endif %}
    </main>
</div>
{% endblock %}
